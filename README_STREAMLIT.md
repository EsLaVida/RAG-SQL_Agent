# ๐ RAG-SQL Agent: ะะพะปะฝะพะต ััะบะพะฒะพะดััะฒะพ ะฟะพ ะทะฐะฟััะบั

## ๐ ะะฑะทะพั ัะธััะตะผั

**RAG-SQL Agent** - ััะพ ะธะฝัะตะปะปะตะบััะฐะปัะฝะฐั ัะธััะตะผะฐ ะดะปั ะฐะฝะฐะปะธะทะฐ ะฑะฐะท ะดะฐะฝะฝัั SQL ั:
- ๐ค Multi-agent ะฐััะธัะตะบัััะพะน (ะพัะบะตัััะฐัะพั + ะฒะฐะปะธะดะฐัะพั + ะพะฟัะธะผะธะทะฐัะพั)
- ๐๏ธ PostgreSQL ะฑะฐะทะพะน ะดะฐะฝะฝัั
- ๐ FastAPI REST API
- ๐จ Streamlit frontend
- ๐ Langfuse ะผะพะฝะธัะพัะธะฝะณ

---

## ๐๏ธ ะฃััะฐะฝะพะฒะบะฐ ะธ ะฝะฐัััะพะนะบะฐ

### 1. ะะปะพะฝะธัะพะฒะฐะฝะธะต ะธ ัััะฐะฝะพะฒะบะฐ ะทะฐะฒะธัะธะผะพััะตะน
```bash
git clone <repository-url>
cd RAG-SQL_Agent

# ะกะพะทะดะฐะฝะธะต ะฒะธัััะฐะปัะฝะพะณะพ ะพะบััะถะตะฝะธั
python -m venv venv
source venv/bin/activate  # Linux/Mac
# ะธะปะธ
venv\Scripts\activate  # Windows

# ะฃััะฐะฝะพะฒะบะฐ ะทะฐะฒะธัะธะผะพััะตะน
pip install -r requirements.txt
```

### 2. ะะฐัััะพะนะบะฐ ะฟะตัะตะผะตะฝะฝัั ะพะบััะถะตะฝะธั
ะกะพะทะดะฐะนัะต ัะฐะนะป `.env` ะฒ ะบะพัะฝะต ะฟัะพะตะบัะฐ:
```env
# OpenRouter API
OPENAI_API_KEY=sk-or-v1-your-openrouter-key
OPENAI_BASE_URL=https://openrouter.ai/api/v1

# PostgreSQL ะฑะฐะทะฐ ะดะฐะฝะฝัั
DB_HOST=localhost
DB_PORT=5432
DB_NAME=company_data
DB_USER=postgres
DB_PASSWORD=postgres

# Langfuse ะผะพะฝะธัะพัะธะฝะณ (ะพะฟัะธะพะฝะฐะปัะฝะพ)
LANGFUSE_PUBLIC_KEY=your-public-key
LANGFUSE_SECRET_KEY=your-secret-key
LANGFUSE_HOST=http://localhost:3000
```

### 3. ะะฐัััะพะนะบะฐ PostgreSQL
```bash
# ะะฐะฟััะบ PostgreSQL (Docker)
docker run --name postgres-rag \
  -e POSTGRES_DB=company_data \
  -e POSTGRES_USER=postgres \
  -e POSTGRES_PASSWORD=postgres \
  -p 5432:5432 \
  -d postgres:15

# ะะฝะธัะธะฐะปะธะทะฐัะธั ะฑะฐะทั ะดะฐะฝะฝัั
python setup_db.py
```

---

## ๐ ะะฐะฟััะบ ัะธััะตะผั

### ะกะฟะพัะพะฑ 1: ะะพะปะฝัะน ััะตะบ (ัะตะบะพะผะตะฝะดัะตััั)

#### ะจะฐะณ 1: ะะฐะฟััะบ Backend (FastAPI)
```bash
# ะขะตัะผะธะฝะฐะป 1
python app.py
```
Backend ะฑัะดะตั ะดะพัััะฟะตะฝ ะฝะฐ `http://localhost:8000`

#### ะจะฐะณ 2: ะะฐะฟััะบ Frontend (Streamlit)
```bash
# ะขะตัะผะธะฝะฐะป 2
streamlit run streamlit_app.py
```
Frontend ะฑัะดะตั ะดะพัััะฟะตะฝ ะฝะฐ `http://localhost:8501`

### ะกะฟะพัะพะฑ 2: ะขะพะปัะบะพ Backend
```bash
python main.py
```
ะะฐะฟััะบะฐะตั CLI ัะตะถะธะผ ะดะปั ัะตััะธัะพะฒะฐะฝะธั

### ะกะฟะพัะพะฑ 3: ะขะพะปัะบะพ Frontend (ััะตะฑัะตั ะทะฐะฟััะตะฝะฝัะน backend)
```bash
streamlit run streamlit_app.py
```

---

## ๐จ ะะพะทะผะพะถะฝะพััะธ Frontend (Streamlit)

### ๐ฑ ะัะฝะพะฒะฝัะต ััะฝะบัะธะธ:
- **๐ฌ ะงะฐั ะธะฝัะตััะตะนั** ั ะธััะพัะธะตะน ัะพะพะฑัะตะฝะธะน
- **๐ SQL ะทะฐะฟัะพัั** ั ะฟะพะดัะฒะตัะบะพะน ัะธะฝัะฐะบัะธัะฐ
- **๐ ะะธะทัะฐะปะธะทะฐัะธั ะดะฐะฝะฝัั** (ะณัะฐัะธะบะธ, ะดะธะฐะณัะฐะผะผั)
- **๐พ ะฃะฟัะฐะฒะปะตะฝะธะต ัะตััะธัะผะธ** (ัะพััะฐะฝะตะฝะธะต ะบะพะฝัะตะบััะฐ)
- **๐ ะะฝะฐะปะธัะธะบะฐ ัะตะทัะปััะฐัะพะฒ** ะฒ ัะตะฐะปัะฝะพะผ ะฒัะตะผะตะฝะธ

### ๐ฏ ะะฝัะตัะฐะบัะธะฒะฝัะต ัะปะตะผะตะฝัั:
- ะัะฑะพั ะบะพะปะพะฝะพะบ ะดะปั ะฟะพัััะพะตะฝะธั ะณัะฐัะธะบะพะฒ
- ะขะธะฟั ะฒะธะทัะฐะปะธะทะฐัะธะน (ััะพะปะฑัะฐััะต, ะปะธะฝะตะนะฝัะต, ัะพัะตัะฝัะต)
- ะญะบัะฟะพัั ะดะฐะฝะฝัั ะฒ ัะฐะทะปะธัะฝัั ัะพัะผะฐัะฐั
- ะัะธััะบะฐ ะธััะพัะธะธ ะธ ัะพะทะดะฐะฝะธะต ะฝะพะฒัั ัะตััะธะน

---

## ๐ง API ะดะพะบัะผะตะฝัะฐัะธั

### ะญะฝะดะฟะพะธะฝั: `POST /chat`

**Request:**
```json
{
  "text": "ะะพะบะฐะถะธ ะฒัะตั ัะพัััะดะฝะธะบะพะฒ ะธะท IT ะพัะดะตะปะฐ",
  "session_id": "optional-session-id"
}
```

**Response:**
```json
{
  "reply": "ะะพั ัะฟะธัะพะบ ัะพัััะดะฝะธะบะพะฒ IT ะพัะดะตะปะฐ...",
  "session_id": "generated-or-existing-session-id"
}
```

---

## ๐ ะะพะฝะธัะพัะธะฝะณ

### Langfuse Dashboard
- URL: `http://localhost:3000`
- ะะพะณะธัะพะฒะฐะฝะธะต ะฒัะตั ะทะฐะฟัะพัะพะฒ ะบ LLM
- ะะฝะฐะปะธัะธะบะฐ ะฟัะพะธะทะฒะพะดะธัะตะปัะฝะพััะธ
- ะััะปะตะถะธะฒะฐะฝะธะต ะพัะธะฑะพะบ

### PostgreSQL
- ะะฐะทะฐ: `company_data`
- ะขะฐะฑะปะธัั: `departments`, `employees`, `checkpoints`, `writes`
- ะงะตะบะฟะพะธะฝัั LangGraph ะดะปั ะฟะตััะธััะตะฝัะฝะพััะธ

---

## ๐งช ะขะตััะธัะพะฒะฐะฝะธะต

### ะัะพะฒะตัะบะฐ ะฟะพะดะบะปััะตะฝะธั
```bash
# ะขะตัั PostgreSQL
python -c "import psycopg2; print('PostgreSQL OK')"

# ะขะตัั API
curl -X POST http://localhost:8000/chat \
  -H "Content-Type: application/json" \
  -d '{"text": "ัะตัั"}'
```

### ะัะธะผะตัั ะทะฐะฟัะพัะพะฒ
- "ะะพะบะฐะถะธ ะฒัะตั ัะพัััะดะฝะธะบะพะฒ"
- "ะะฐะบะฐั ััะตะดะฝัั ะทะฐัะฟะปะฐัะฐ ะฟะพ ะพัะดะตะปะฐะผ?"
- "ะัะพ ัะฐะผัะน ะฒััะพะบะพะพะฟะปะฐัะธะฒะฐะตะผัะน ัะพัััะดะฝะธะบ?"
- "ะกะบะพะปัะบะพ ัะพัััะดะฝะธะบะพะฒ ะฒ ะบะฐะถะดะพะผ ะพัะดะตะปะต?"

---

## ๐ Troubleshooting

### ะงะฐัััะต ะฟัะพะฑะปะตะผั:

1. **ะัะธะฑะบะฐ ะฟะพะดะบะปััะตะฝะธั PostgreSQL**
   ```bash
   # ะัะพะฒะตัััะต ััะฐััั
   docker ps | grep postgres
   ```

2. **Frontend ะฝะต ะฟะพะดะบะปััะฐะตััั ะบ API**
   - ะฃะฑะตะดะธัะตัั ััะพ backend ะทะฐะฟััะตะฝ ะฝะฐ ะฟะพััั 8000
   - ะัะพะฒะตัััะต CORS ะฝะฐัััะพะนะบะธ ะฒ FastAPI

3. **Langfuse ะฝะต ะปะพะณะธััะตั**
   - ะัะพะฒะตัััะต ะฟะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั LANGFUSE_*
   - ะฃะฑะตะดะธัะตัั ััะพ Langfuse ัะตัะฒะตั ะทะฐะฟััะตะฝ

---

## ๐๏ธ ะััะธัะตะบัััะฐ

```
โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ
โ   Streamlit    โ    โ    FastAPI     โ    โ   LangGraph    โ
โ   Frontend    โโโโโบโ   Backend      โโโโโบโ   Agent        โ
โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ
                                                      โ
                                              โโโโโโโโโโโโโโโโโโโ
                                              โ   PostgreSQL   โ
                                              โ   Database     โ
                                              โโโโโโโโโโโโโโโโโโโ
```

---

## ๐ ะะฐะทัะฐะฑะพัะบะฐ

### ะะพะฑะฐะฒะปะตะฝะธะต ะฝะพะฒัั ะธะฝััััะผะตะฝัะพะฒ:
1. ะกะพะทะดะฐะนัะต ััะฝะบัะธั ะฒ `src/tools.py`
2. ะะพะฑะฐะฒััะต ะธะฝััััะผะตะฝั ะฒ `src/agent.py`
3. ะะตัะตะทะฐะฟัััะธัะต ัะธััะตะผั

### ะะทะผะตะฝะตะฝะธะต ะฟัะพะผะฟัะพะฒ:
- ะคะฐะนะป: `config/prompts.py`
- ะะตัะตะทะฐะฟัััะธัะต ะฟะพัะปะต ะธะทะผะตะฝะตะฝะธะน

---

## ๐ ะะพัะพะฒะพ ะบ ะธัะฟะพะปัะทะพะฒะฐะฝะธั!

ะะพัะปะต ะฒัะฟะพะปะฝะตะฝะธั ะฒัะตั ัะฐะณะพะฒ ั ะฒะฐั ะฑัะดะตั ะฟะพะปะฝะพััะฝะบัะธะพะฝะฐะปัะฝะฐั ัะธััะตะผะฐ:
- โ Production-ready backend
- โ ะกะพะฒัะตะผะตะฝะฝัะน frontend ะธะฝัะตััะตะนั  
- โ ะะตััะธััะตะฝัะฝะพััั ะดะฐะฝะฝัั
- โ ะะพะฝะธัะพัะธะฝะณ ะธ ะฐะฝะฐะปะธัะธะบะฐ
- โ ะะฐัััะฐะฑะธััะตะผะฐั ะฐััะธัะตะบัััะฐ

**ะะฐัะฝะธัะต ั `streamlit run streamlit_app.py` ะธ ะฝะฐัะปะฐะถะดะฐะนัะตัั!** ๐
